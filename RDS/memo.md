## 概要
門木さんと実施したwordpress用RDSのバージョンアップ対応

## 前提
- 対象はRDS(mysql5.7)で、wordoress用なので、社員が更新をしない限りはデータ更新がない
- 旧RDSからdumpしたデータを新バージョンで作成したRDSに入れて更新する

## 事前準備
- password
  - 旧RDSのマスターユーザーのパスワードを確認しておく
  - 新RDSのパスワードを決める（基本は今までと同じパスワードでいいと思う）
- wp-config.php ファイルの確認
  - RDSのエンドポイントが記載された部分を確認しておく
  - RDSが冗長構成をとっており、設定ファイルにリーダーとライターのエンドポイントをそれぞれ記載している場合その分だけ更新する必要がある
    - "wp-config.php"ファイル以外に記載されている場合もあるかもしれないので、念の為grepで再起的に検索しておくと盤石（サーバー負荷高いので利用者が少ない時間帯で実施）
- dump対象データベースの確認
- user名と権限の確認
  
## 手順
- マスターユーザーで以下を実行する
  1. dump対象データベースからdumpファイルの取得
  2. ユーザー作成のコマンドの取得（スナップショットから既にユーザー作成している場合は不要）
  3. 取得したdumpファイルを新バージョンのRDSに流す
  4. 新旧のRDSのデータで差異がないか確認する
  5. wp-config.php ファイルのデータベースのエンドポイントを新しいRDSのエンドポイントに切り替える
  6. 疎通確認
  7. 旧RDSを一時的に停止しても問題がないか確認する